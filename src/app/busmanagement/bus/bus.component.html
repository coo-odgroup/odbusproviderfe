
<ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "large" color = "#fff" type = "timer" [fullScreen] = "true"><p style="color: white" > Loading... </p></ngx-spinner>

<div class="row">
  <div class="col-sm-12">
      <app-card [hidHeader]="false" cardTitle="BUS" cardClass="card-datatable"  [options]="false"
      cardClass=" table-border-style user-profile-list ">
      <div class="row">
        <div class="col-2">
          <div class="from-group ">
            <button class="btn sml_input btn-success mb-2 " (click)="ResetAttributes();OpenModal(wizardContent)">
              Add Bus
            </button>
          </div>
        </div>
        <div class="col-10">
          <form [formGroup]="searchForm">
            <div class="row">
              <div class="col-4">
                <div class="form-group row"> 
                  <div class="col-sm-12">
                    
                      <ng-select [items]="operators" bindLabel="operatorData" bindValue="id"
                        placeholder="Select Operator" formControlName="operator" [clearable]="false">
                      </ng-select>                      
                   
                  </div>                           
                </div>              
              </div>
              <div class="col-2">
                <div class="form-group row">            
                  <div class="dropdown">
                    <div class="col-sm-12">
                      <select class="form-control sml_input" formControlName="status">
                        <option value='1'>Active</option>
                        <option value='0'>Panding</option>
                    </select>
                    <small>Status</small>
                    </div>                    
                    
                </div>              
                </div>              
              </div>

              <div class="col-4">
                <div class="form-group row">

                  <div class="col-sm-12">
                      <div class="input-group">
                        <input type="text" class="form-control sml_input" placeholder="Search Here " required
                        formControlName="name" (keyup.enter)="search()">
                        <div class="input-group-append">
                          <button type="button" class="btn btn-success  sml_input" (click)="search()" title="search">
                            <i class="fas fa-search"> </i> 
                          </button>                        
                        </div>
                      </div>  
                  </div>
                </div>
              
              </div>            
              



              <div class="col-2">
                <div class="dropdown float-right">
                  <select class="form-control sml_input" formControlName="rows_number" (change)=search()>
                    <option value=10>10</option>
                    <option value=25>25</option>
                    <option value=50>50</option>
                    <option value=100>100</option>
                    <option value='all'>All</option>
                  </select>
                </div>
              </div>

            </div>
          </form>


        </div>

      </div>
      <div class="row">
        <div class="col-4">
          <!-- <button type="button" class="btn btn-success  sml_input" (click)="search()"
              title="search">
              <i class="fas fa-search"> </i> Search
          </button> -->
          <button type="button" class="btn btn-danger sml_input" (click)="refresh()"
              title="refresh">
              <i class="fas fa-sync-alt"> </i> Refresh
          </button>
          <button type="button" (click)="exportexcel()" class="btn btn-warning  sml_input"
              title="Export">
              <i class="fas fa-file-export"> </i> Export
          </button>
          <button type="button" printSectionId="print-section" ngxPrint
              class="btn btn-info sml_input" [useExistingCss]="true" title="Print">
              <i class="fas fa-print"> </i> Print
          </button>
      </div>
      </div>

      <div class="table-responsive" id="print-section" >
        <table class="table table-striped ">
          <thead>
            <tr>
              <th>#</th>
              <th style="width: 150px;">Bus Operator</th>
              <th style="width: 150px;">Bus Name</th>
              <th>Bus Number</th>
              <!-- <th>Via</th>    -->
              <th>Source >> Destination</th>     
              <th>Created/Updated On</th> 
              <th>Created By</th>       
              <th>Status</th>             
              <th class="hide_print" width='150'>&nbsp;</th>
              <th width="100" class="hide_print" >&nbsp; </th>
            </tr>
          </thead>
          <tbody *ngIf="buses?.length != 0">
            <tr *ngFor="let bus of buses; let i=index; ">

              <td>{{i+1}}</td>
              <td>{{bus.bus_operator.organisation_name }}<br>[{{ bus.bus_operator.operator_name }}]</td>
              <td>{{ bus.name }}  <br> (Bus ID : {{bus.id}}) </td>
              <td class="text-uppercase">{{ bus.bus_number }}</td>
              <!-- <td>{{ bus.via}}</td> -->
              <td>
                <span *ngIf="bus.ticket_price[0].from_location?.length != 0 && bus.ticket_price[0].to_location?.length != 0 ">
                  {{bus.ticket_price[0].from_location[0].name}} >>  {{bus.ticket_price[0].to_location[0].name}} 
              </span>
              <span *ngIf="bus.ticket_price[0].from_location?.length == 0">
                        no route.
              </span>
              </td>
              <td>{{ bus.updated_at| date: 'dd/MM/yyyy' }}</td>
              <td>{{ bus.created_by }}</td>
              <td>
                <label *ngIf="bus.status==1" class="badge badge-light-primary pointer text-dark"
                  (click)="changeStatus($event, bus.id);">Active</label>
                <label *ngIf="bus.status==0" class="badge badge-light-danger pointer text-dark"
                  (click)="changeStatus($event, bus.id);">Pending</label>
              </td>
              <td class="hide_print">
                <div ngbDropdown container="body">
                  <button class="btn btn-sm btn-outline-secondary" id="dropdownMenu{{ bus.id }}"
                    ngbDropdownToggle>Action</button>
                  <div class="dropdown-menu" aria-labelledby="dropdownMenu{{ bus.id }}" ngbDropdownMenu>
                    <button ngbDropdownItem class="dropdown-item btn btn-sm" style="width: 100%;"
                      (click)="ResetAttributes();LoadAllService();BusCopy($event, i); OpenModal(copyBus);"><i
                        class="icon feather icon-copy f-w-600 f-16 m-r-15 text-c-green"></i> Copy</button>
                    <button ngbDropdownItem class="dropdown-item btn btn-sm" style="width: 100%;"
                      (click)="ResetAttributes();LoadAllService();BusClone($event, i); OpenModal(copyBus);"><i
                        class="icon feather icon-copy f-w-600 f-16 m-r-15 text-c-green"></i> Clone</button>
                    <button ngbDropdownItem class="dropdown-item btn btn-sm" style="width: 100%;"
                      (click)="ResetAttributes();editRoutes($event,i); OpenModal(BusRoutes)"><i
                        class="icon feather icon-edit f-w-600 f-16 m-r-15 text-c-green"></i> Edit Seats & Routes</button>


                    <!-- <button ngbDropdownItem class="dropdown-item btn btn-sm" style="width: 100%;"
                      (click)="ResetAttributes();editSeatLayout($event, i); OpenModal(editSeat);"><i
                        class="icon feather icon-edit f-w-600 f-16 m-r-15 text-c-green"></i> Edit Seat</button> -->

                    <button ngbDropdownItem class="dropdown-item btn btn-sm" style="width: 100%;"
                      (click)="ResetAttributes();editBus($event, i); OpenModal(editcontent);"><i
                        class="icon feather icon-edit f-w-600 f-16 m-r-15 text-c-green"></i> Edit Basic Info</button>
                    <button ngbDropdownItem class="dropdown-item btn btn-sm" style="width: 100%;"
                      (click)="ResetAttributes();editContact($event, i); OpenModal(contactinfo)"><i
                        class="icon feather icon-edit f-w-600 f-16 m-r-15 text-c-green"></i> Edit Contact</button>
                    <!-- <button ngbDropdownItem class="dropdown-item btn btn-sm" style="width: 100%;"><i
                        class="icon feather icon-edit f-w-600 f-16 m-r-15 text-c-green"></i> Edit Seat Fare</button> -->
                    <button ngbDropdownItem class="dropdown-item btn btn-sm" style="width: 100%;"
                      (click)="ResetAttributes();editExtraSeat($event, i); OpenModal(editExtraSeatLayout);"><i
                        class="icon feather icon-edit f-w-600 f-16 m-r-15 text-c-green"></i> Edit More Seats</button>

                    <!-- <button ngbDropdownItem class="dropdown-item btn btn-sm" style="width: 100%;" (click)="ResetAttributes();BusReview(i); OpenModal(busReviewModal)"><i class="icon feather icon-thumbs-up f-w-600 f-16 m-r-15 text-c-green" ></i> Review</button> -->


                  </div> &nbsp; &nbsp;
                </div>

              </td>

              <td class="hide_print">
                <div class="overlay-edit">
                    <button type="button" (click)="deleteBus(confirmDialog, bus.id)"
                        class="btn btn-icon btn-danger"><i class="feather icon-trash-2"></i></button>
                    <button type="button" (click)="ResetAttributes();busData(i); OpenModal(busDetails);"
                        class="btn btn-icon btn-warning"><i class="feather icon-eye"></i></button>
                </div>
            </td>
            </tr>
          </tbody>
          <tbody *ngIf="buses?.length == 0">
            <tr>
              <td colspan="10" class="no-data-available">No data!</td>
            </tr>
          <tbody>
        </table> 
        <div *ngIf="pagination?.length!= 0" class="hide_print container">
          <div class="row">
            <div class="col-6">
             
                <div class="col-12">
                  <p class=" row mt-3 ml-1"> Showing {{all?.count}} of {{all?.total}} records. </p>
                </div> 
            </div>
            <div class="col-6">
              <div class="d-flex flex-row-reverse mb-4 text-center" *ngIf="pagination?.links">
                <nav class="my-1 pt-1 ">
                    <ul class="pagination pagination-circle pg-blue mb-0">
                        <li (click)="search(pagination.first_page_url,statusLabel)"
                            class="page-item {{ pagination.current_page == 1 ? 'disabled' : '' }} clearfix d-none d-md-block">
                            <a class="page-link">First</a>
                        </li>
                        <li class="page-item " *ngFor="let b of pagination.links ; let i = index ">
                            <a class="page-link {{ pagination.current_page == b.label ? 'active' : '' }}"
                                (click)="(b.url) ? search(b.url) : ''"
                                [innerHTML]="page(b.label)"></a>
                        </li>
                        <li class="page-item {{ pagination.last_page == 1 ? 'disabled' : '' }} clearfix d-none d-md-block"
                            (click)="search(pagination.last_page_url,statusLabel)">
                            <a class="page-link">Last</a>
                        </li>
                    </ul>
                </nav>
            </div>
  
            </div>
  
          </div>
        </div>      
      </div>
      <div class="app-card-footer">
        <ng-template #copyBus let-modal>
          <div class="modal-header">
            <h5 class="ng-tns-c116-5" id="boxheading">{{ModalHeading}}</h5>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-sm-12">
                <div class="form-material">
                  <div class="right-icon-control">
                    
                    <form [formGroup]="busForm" class="editForm" novalidate>

                      <aw-wizard #wizard class="arc-wizard arc-custom" navBarLayout="large-filled-symbols">
                        <aw-wizard-step stepTitle="Bus Info"
                          [navigationSymbol]="{ symbol: '&#xe8e9;', fontFamily: 'feather' }" [style.font-weight]="900">
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group row">

                                <label for="bus" class="col-sm-4 col-form-label">Operator <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="operators" bindLabel="operatorData" bindValue="id"
                                    placeholder="Select Operator" formControlName="bus_operator_id" [clearable]="false">
                                  </ng-select>
                                  <!-- <select class="form-control"  required   formControlName="bus_operator_id">
                                <option *ngFor="let operator of operators;" [value]="operator.id" >{{operator.operator_name}}</option>
                              </select> -->
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['bus_operator_id'].touched && busForm.controls['bus_operator_id'].hasError('required')">
                                    Operator Name is required! </span>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Bus Name <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">

                                  <input type="text" class="form-control" placeholder="Enter Bus name" required
                                    formControlName="name" [value]="busRecord.name" />
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['name'].touched && busForm.controls['name'].hasError('required')">
                                    Bus name is required! </span>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Via <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <input type="text" class="form-control" placeholder="Enter via" required
                                    formControlName="via" [value]="busRecord.via" />
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['via'].touched && busForm.controls['via'].hasError('required')">
                                    Via is required! </span>
                                </div>
                              </div>
                            </div>
                            
                            <div class="col-md-6">

                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Bus Number<span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <!-- [value]="busRecord.bus_number1" alt+z-->
                                  <input type="text" class="form-control text-uppercase" placeholder="Enter Bus Number"
                                    formControlName="bus_number" />
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.bus_number.touched && busForm.controls.bus_number.hasError('required')">
                                    Bus Number is required! </span>
                                </div>

                              </div>
                              
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Amenities <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="amenities" [multiple]="true" bindLabel="name" bindValue="id"
                                    placeholder="Choose Amenities" formControlName="amenities" [clearable]="false">
                                  </ng-select>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['amenities'].touched && busForm.controls['amenities'].hasError('required')">
                                    Amenities is required! </span>
                                </div>
                              </div>
                            </div>
                            <div class="col-6">

                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Bus Safety <span
                                  class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="safetyies" [multiple]="true" bindLabel="name" bindValue="id"
                                    placeholder="Choose Safety" formControlName="safety" [clearable]="false">
                                  </ng-select>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['safety'].touched && busForm.controls['safety'].hasError('required')">
                                    Safety is required! </span>

                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Seating Type <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="busSeatingTypes" bindLabel="name" bindValue="id"
                                    placeholder="Select Seat Type" formControlName="bus_sitting_id" [clearable]="false">
                                  </ng-select>

                                  <span class="text-danger"
                                    *ngIf="busForm.controls['bus_sitting_id'].touched && busForm.controls['bus_sitting_id'].hasError('required')">
                                    Seating Type is required! </span>
                                </div>
                              </div>
                            </div>

                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Display Info</label>
                                <div class="col-sm-8">
                                  <input type="text" class="form-control" formControlName="bus_description" />

                                </div>
                              </div>
                            </div>

                          </div>

                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Cancellation Points</label>
                                <div class="col-sm-8">
                                  <input type="text" class="form-control" placeholder="cancellation additional points"
                                    formControlName="cancelation_points" [value]="busRecord.cancelation_points" />
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Max Seat Book<span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <input type="text" class="form-control" formControlName="max_seat_book">
                                </div>
                              </div>

                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Cancellation Slab <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="cancellationslabs" bindLabel="rule_name" bindValue="id"
                                    placeholder="Select Cancellation Slab" formControlName="cancellationslabs_id"
                                    (ngModelChange)="getCancellationRule($event)" (change)="getCancellationRule($event)"
                                    [clearable]="false">
                                  </ng-select>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['cancellationslabs_id'].touched && busForm.controls['cancellationslabs_id'].hasError('required')">
                                    Cancellation Slab is required! </span>


                                </div>
                              </div>
                              <!--
                                  SHOW CANCELLATION RULE TABLE HERE
                                -->


                            </div>
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Bus Type <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="busTypes" bindLabel="name" bindValue="id"
                                    placeholder="Select Bus Type" formControlName="bus_type_id" [clearable]="false">
                                  </ng-select>

                                  <span class="text-danger"
                                    *ngIf="busForm.controls['bus_type_id'].touched && busForm.controls['bus_type_id'].hasError('required')">
                                    Bus Type is required! </span>
                                </div>
                              </div>                             
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="row form-group">
                                <div class="col-6" *ngIf="allDurations?.length > 0"
                                  style="margin-top: 20px; font-size: 12px;">
                                  <strong>Hours before Dep:</strong>
                                  <div *ngFor="let cSlabduration of allDurations; let durationIndex=index;"
                                    style="border-bottom: 1px solid #000;">
                                    <strong>{{durationIndex+1}}</strong>. {{ cSlabduration.duration}}
                                  </div>
                                </div>
                                <div class="col-6" *ngIf="allDurations?.length > 0"
                                  style="margin-top: 20px; font-size: 12px;">
                                  <strong>Cancellation Charges:</strong>
                                  <div *ngFor="let cSlabdeduction of allDurations; let deductionIndex=index;"
                                    style="border-bottom: 1px solid #000;"><strong>{{deductionIndex+1}}</strong>. {{
                                    cSlabdeduction.deduction}} %</div>
                                </div>

                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-12 centered-content">
                              <div class="btn-group mt-10">
                                <button type="button" class="btn btn-primary btn-sm" awNextStep>Continue</button>
                              </div>
                            </div>
                          </div>
                        </aw-wizard-step>
                        <aw-wizard-step stepTitle="Layout"
                          [navigationSymbol]="{ symbol: '&#xe88c;', fontFamily: 'feather' }" [style.font-weight]="900">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-2 col-form-label">Seat Layout <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-4">
                                  <ng-select [items]="seatLayouts" bindLabel="name" bindValue="id"
                                    placeholder="Select Seat Layout" formControlName="bus_seat_layout_id"
                                    (ngModelChange)="getSeatLayout($event)" (change)="getSeatLayout($event)"
                                    [clearable]="false">
                                  </ng-select>

                                  <!-- <select class="form-control" required (change)="getSeatLayout($event.target.value)" formControlName="bus_seat_layout_id" [value]="busRecord.bus_seat_layout_id">
                                      <option *ngFor="let seatLayout of seatLayouts" [value]="seatLayout.id">{{seatLayout.name}}</option>
                                    </select> -->
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['bus_seat_layout_id'].touched && busForm.controls['bus_seat_layout_id'].hasError('required')">
                                    Seat Layout is required! </span>
                                </div>
                                <div formArrayName="bus_seat_layout_data" class="col-12">

                                  <div class="row"
                                    *ngFor="let layoutRow of busForm.controls.bus_seat_layout_data.controls; let layout_row=index;"
                                    [formGroupName]="layout_row">
                                    <div formArrayName="lowerBerth" class="col-12"
                                      style="display: flex;justify-content: center;">
                                      <div
                                        *ngFor="let layoutCol of layoutRow['controls'].lowerBerth['controls']; let layout_row=index;"
                                        [formGroupName]="layout_row"
                                        style="width: 50px; float: left;  text-align: center;">
                                        <!-- (change)="chooseSeat($event.target.checked,layoutCol.controls.seatType.value,layoutCol.controls.seatText.value,1)" -->
                                        <label class="seatHolder">
                                          <input type="checkbox" formControlName="seatChecked"
                                            *ngIf="layoutCol.controls.seatType.value!=4">
                                          <span class="seaterImage" *ngIf="layoutCol.controls.seatType.value==1"></span>
                                          <span class="sleeperImage"
                                            *ngIf="layoutCol.controls.seatType.value==2"></span>
                                          <span class="verticalImage"
                                            *ngIf="layoutCol.controls.seatType.value==3"></span>
                                          <span class="blankImage" *ngIf="layoutCol.controls.seatType.value==4"></span>
                                          <span
                                            *ngIf="layoutCol.controls.seatType.value!=4">{{layoutCol.controls.seatText.value}}</span>

                                        </label>
                                      </div>
                                    </div>

                                    <div formArrayName="upperBerth" class="col-12"
                                      style="display: flex;justify-content: center;">
                                      <div
                                        *ngFor="let layoutCol of layoutRow['controls'].upperBerth['controls']; let layout_row=index;"
                                        [formGroupName]="layout_row"
                                        style="width: 50px; float: left;  text-align: center;">

                                        <label class="seatHolder">
                                          <input type="checkbox" formControlName="seatChecked"
                                            *ngIf="layoutCol.controls.seatType.value!=4">
                                          <span class="seaterImage" *ngIf="layoutCol.controls.seatType.value==1"></span>
                                          <span class="sleeperImage"
                                            *ngIf="layoutCol.controls.seatType.value==2"></span>
                                          <span class="verticalImage"
                                            *ngIf="layoutCol.controls.seatType.value==3"></span>
                                          <span class="blankImage" *ngIf="layoutCol.controls.seatType.value==4"></span>
                                          <span
                                            *ngIf="layoutCol.controls.seatType.value!=4">{{layoutCol.controls.seatText.value}}</span>

                                        </label>
                                      </div>
                                    </div>
                                  </div>

                                </div>

                              </div>
                            </div>
                            <div class="col-sm-12 centered-content">
                              <div class="btn-group mt-10">
                                <button type="button" class="btn btn-secondary btn-sm" awPreviousStep>Back</button>
                                <button type="button" class="btn btn-primary btn-sm" awNextStep>Continue</button>
                              </div>
                            </div>
                          </div>

                        </aw-wizard-step>
                        <aw-wizard-step stepTitle="Contact Info"
                          [navigationSymbol]="{ symbol: '&#xe848;', fontFamily: 'feather' }"
                          navigationSymbolFontFamily="Font Awesome\ 5 Free" [style.font-weight]="900">

                          <div class="form-group" style="font-weight:bold">Contact Information For Bus</div>
                          <div class="col-12">
                            <div class="col-12">                              
                              <!-- start -->
                              <div class="form-group row">
                                <label for="bus" class="col-sm-3 col-form-label">Lable </label>
                                <label for="bus" class="col-sm-4 col-form-label">Contact Number </label>
                                <label for="bus" class="col-sm-2 col-form-label">SMS On Ticket </label>
                                <label for="bus" class="col-sm-3 col-form-label">SMS On Cancellation </label>
                              </div>

                              <div class="form-group row">
                                <label for="bus" class="col-sm-3 ">Conductor</label>
                                <div class="col-sm-4 ">
                                  <input type="text" class="form-control" placeholder="Enter Mobile No"
                                    formControlName="conductor_no" />
                                  <!-- <span class="text-danger"
                                    *ngIf="busForm.controls.conductor_no.touched && busForm.controls.conductor_no.hasError('required')">
                                    Contact Number is Required
                                  </span> -->
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.conductor_no.touched && busForm.controls['conductor_no'].errors?.minlength">
                                    Min 10 Digit Number is Required
                                  </span>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.conductor_no.touched && busForm.controls.conductor_no.hasError('maxlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger" *ngIf="busForm.controls.conductor_no.errors?.pattern">
                                    Enter only Digits
                                  </span>
                                </div>
                                <div class="col-sm-2 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitch1{{k}}"
                                      formControlName="c_sms_ticket">
                                    <label class="custom-control-label" for="customswitch1{{k}}"></label>
                                  </div>
                                </div>
                                <div class="col-sm-3 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitch2{{k}}"
                                      formControlName="c_sms_cancel">
                                    <label class="custom-control-label" for="customswitch2{{k}}"></label>
                                  </div>
                                </div>
                              </div>

                              <div class="form-group row">
                                <label for="bus" class="col-sm-3 ">Manager</label>
                                <div class="col-sm-4 ">
                                  <input type="text" class="form-control" placeholder="Enter Mobile No"
                                    formControlName="manager_no" />
                                  <!-- <span class="text-danger"
                                    *ngIf="busForm.controls.manager_no.touched && busForm.controls.manager_no.hasError('required')">
                                    Contact Number is Required
                                  </span> -->
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.manager_no.touched && busForm.controls.manager_no.hasError('minlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.manager_no.touched && busForm.controls.manager_no.hasError('maxlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger" *ngIf="busForm.controls.manager_no.errors?.pattern">
                                    Enter only Digits
                                  </span>
                                </div>
                                <div class="col-sm-2 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitcha{{k}}"
                                      formControlName="m_sms_ticket">
                                    <label class="custom-control-label" for="customswitcha{{k}}"></label>
                                  </div>
                                </div>
                                <div class="col-sm-3 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitchb{{k}}"
                                      formControlName="m_sms_cancel">
                                    <label class="custom-control-label" for="customswitchb{{k}}"></label>
                                  </div>
                                </div>
                              </div>

                              <div class="form-group row">
                                <label for="bus" class="col-sm-3 ">Owner</label>
                                <div class="col-sm-4 ">
                                  <input type="text" class="form-control" placeholder="Enter Mobile No"
                                    formControlName="owner_no" />

                                  <!-- <span class="text-danger"
                                    *ngIf="busForm.controls.owner_no.touched && busForm.controls.owner_no.hasError('required')">
                                    Contact Number is Required
                                  </span> -->
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.owner_no.touched && busForm.controls.owner_no.hasError('minlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.owner_no.touched && busForm.controls.owner_no.hasError('maxlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger" *ngIf="busForm.controls.owner_no.errors?.pattern">
                                    Enter only Digits
                                  </span>

                                </div>
                                <div class="col-sm-2 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitch5{{k}}"
                                      formControlName="o_sms_ticket">
                                    <label class="custom-control-label" for="customswitch5{{k}}"></label>
                                  </div>
                                </div>
                                <div class="col-sm-3 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitch7{{k}}"
                                      formControlName="o_sms_cancel">
                                    <label class="custom-control-label" for="customswitch7{{k}}"></label>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="col-sm-12 centered-content">
                              <div class="btn-group mt-10">
                                <button type="button" class="btn btn-secondary btn-sm" awPreviousStep>Back</button>
                                <button type="button" class="btn btn-primary btn-sm" awNextStep>Continue</button>
                              </div>
                            </div>
                          </div>

                        </aw-wizard-step>
                        <aw-wizard-step stepTitle="Config Location"
                          [navigationSymbol]="{ symbol: '&#xe861;', fontFamily: 'feather' }"
                          navigationSymbolFontFamily="Font Awesome\ 5 Free" [style.font-weight]="900">

                          <div formArrayName="busRoutes">
                            <div class="row">
                              <div class="col-6" *ngFor="let singleRoute of routeFormGroup.controls; let i = index;">
                                <div [formGroupName]="i" class="row">
                                  <div class="form-group col-5">
                                    <label>Location and Time <span class="text-danger">*</span></label>


                                    <ng-select [items]="locations" bindLabel="name" bindValue="id"
                                      placeholder="Select Location" formControlName="source_id"
                                      (change)="getSource($event,i)" [clearable]="false">
                                    </ng-select>
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.source_id.touched && singleRoute.controls.source_id.hasError('required')">
                                      Source is required! </span>
                                  </div>

                                  <div class="form-group col-md-3">
                                    <label>Time <span class="text-danger">*</span></label>
                                    <input type="time" formControlName="location_time" class="form-control">
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.location_time.touched && singleRoute.controls.location_time.hasError('required')">
                                      Location Time is required! </span>
                                  </div>

                                  <div class="form-group col-md-2">
                                    <label>Seq <span class="text-danger">*</span></label>
                                    <input type="text" formControlName="sequence" class="form-control">
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.sequence.touched && singleRoute.controls.sequence.hasError('required')">
                                      Sequence is required! </span>
                                  </div>
                                  <div class="col-md-1 text-right">
                                    <button class="btn btn-danger btn-sm" type="button" (click)="removeRoute(i)"
                                      style="margin-top: 26px;"> X </button>
                                  </div>
                                  <div class="form-group col-12">
                                    <ng-container formArrayName="sourceBoarding">
                                      <ng-container
                                        *ngFor="let sourceBoardingFormGroup of singleRoute['controls'].sourceBoarding['controls']; let sourceCounts = index">
                                        <div formGroupName="{{sourceCounts}}">

                                          <div class="formgroup row" style="margin-top:10px">
                                            <div class="col-md-1 form-check">

                                              <input type="checkbox" id="source-{{i}}{{sourceCounts}}" [checked]="false"
                                                formControlName="sourcechecked">

                                            </div>
                                            <div class="col-md-6">
                                              <label
                                                for="source-{{i}}{{sourceCounts}}">{{sourceBoardingFormGroup.controls.sourceLocation.value}}</label>

                                            </div>
                                            <div class="col-md-5">
                                              <input type="time" formControlName="sourceTime"
                                                class="form-control required" placeholder="Date" atp-time-picker
                                                value="20:55" onlyHour="true" onlyAM='true'>
                                            </div>
                                          </div>
                                        </div>

                                      </ng-container>
                                    </ng-container>

                                  </div>
                                  
                                  



                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row form-group">
                            <div class="col-12 text-right"><button class="btn btn-primary btn-sm" type="button"
                                (click)="addRoute()"> Add Location +</button></div>
                          </div>
                          <div class="col-sm-12 centered-content">
                            <div class="btn-group mt-10">
                              <button type="button" class="btn btn-secondary btn-sm" awPreviousStep>Back</button>
                              <button type="button" class="btn btn-primary btn-sm" awNextStep>Continue</button>
                            </div>
                          </div>
                        </aw-wizard-step>
                        <aw-wizard-step stepTitle="Completed"
                          [navigationSymbol]="{ symbol: '&#xe840;', fontFamily: 'feather' }" [style.font-weight]="900">
                          <div class="row">
                            <div formArrayName="busRoutesInfo" class="col-12">
                              <div class="col-12"
                                *ngFor="let singleRoute of routeInfoFormGroup.controls; let i = index;">
                                <div [formGroupName]="i" class="row">
                                  <div class="form-group col-2" style="padding:0px 5px;">
                                    <label>From <span class="text-danger">*</span></label>
                                    
                                    <select class="form-control" required formControlName="from_location" type="text">
                                      <option *ngFor="let fromLocation of selectedLocations; let from_lc=index;"
                                        [value]="fromLocation[0].id">{{fromLocation[0].location_name}}</option>
                                    </select>


                                  </div>
                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="bus">On Day</label>
                                    <select class="form-control" formControlName="arr_days" type="text" placement="top"
                                      ngbTooltip="Days">
                                      <option value="1" selected>1</option>
                                      <option value="2">2</option>
                                      <option value="3">3</option>
                                      <option value="4">4</option>
                                      <option value="5">5</option>
                                    </select>
                                  </div>
                                  <div class="form-group col-2" style="padding:0px 5px;">
                                    <label>To <span class="text-danger">*</span></label>

                                    <select class="form-control" required formControlName="to_location" type="text">
                                      <option value="" selected>Choose Location</option>
                                      <option *ngFor="let toLocation of selectedLocations; let to_lc=index;"
                                        [value]="toLocation[0].id">{{toLocation[0].location_name}}</option>
                                    </select>


                                    

                                  </div>
                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="bus">On Day</label>
                                    <select class="form-control" formControlName="dep_days" type="text" placement="top"
                                      ngbTooltip="Days">
                                      <option value="1" selected>1</option>
                                      <option value="2">2</option>
                                      <option value="3">3</option>
                                      <option value="4">4</option>
                                      <option value="5">5</option>
                                    </select>
                                  </div>
                                  <div class="form-group col-md-1 " style="padding:0px 5px;">
                                    <label for="bus">Seat Fare<span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" required formControlName="seater_fare"
                                      [value]="busRecord.seater_fare" placeholder="Seater Fare" placement="top"
                                      ngbTooltip="Seater Fare" />
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.seater_fare.touched && singleRoute.controls.seater_fare.hasError('required')">
                                      Seater Fare is required! </span>
                                  </div>
                                  <div class="form-group col-md-1 " style="padding:0px 5px;">
                                    <label for="bus">Sleeper Fare<span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" required formControlName="sleeper_fare"
                                      [value]="busRecord.sleeper_fare" placeholder="Sleeper Fare" placement="top"
                                      ngbTooltip="Sleeper Fare" />
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.sleeper_fare.touched && singleRoute.controls.sleeper_fare.hasError('required')">
                                      Sleeper Fare is required! </span>
                                  </div>
                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="bus">Seize Time</label>
                                    <input type="text" class="form-control" required formControlName="booking_seized"
                                      [value]="busRecord.booking_seized" placeholder="Enter minute" placement="top"
                                      ngbTooltip="Enter minute here3" (input)="getActualtime(i);"/>
                                     
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.booking_seized.touched && singleRoute.controls.booking_seized.hasError('required')">
                                      Seize Time is required! </span>
                                  </div>
                                  

                                  <div class="form-group col-md-2" style="padding:0px 5px;">
                                    <label for="bus">Actual Time</label>
                                    <input type="time" readonly class="form-control" required formControlName="actual_time"
                                        placement="top"/>
                                     
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.actual_time.touched && singleRoute.controls.actual_time.hasError('required')">
                                     Actual Time is required! </span>
                                  </div>


                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="route_status">Status</label>
                                    <div class="custom-control custom-switch">
                                      <input type="checkbox" class="custom-control-input" id="route_status{{i}}" formControlName="route_status">
                                      <label class="custom-control-label" for="route_status{{i}}"></label>

                                      <button class="btn btn-danger btn-sm" type="button" (click)="removeRouteInfo(i)"> X </button>
                                    </div>
                                  </div>
                                 
                                  <!-- (click)="removeRoute(i)"  -->

                                  <!-- <div class="form-group col-md-1 text-right" style="padding:0px 5px;">
                                    <label>&nbsp;</label>
                                   
                                  </div> -->


                                </div>
                              </div>
                            </div>
                            <div class="col-12">
                              <div class="row form-group">
                                <div class="col-12 text-right"><button class="btn btn-primary btn-sm" type="button"
                                    (click)="addRouteInfo()"> Add New Route +</button></div>
                              </div>
                            </div>

                            <div class="col-sm-12 centered-content">
                              <div class="btn-group mt-10">
                                <button type="button" class="btn btn-secondary btn-sm" awPreviousStep>Back</button>
                                <button type="button" class="btn btn-success btn-sm" awResetWizard>Finished</button>
                              </div>
                            </div>
                          </div>
                        </aw-wizard-step>
                      </aw-wizard>


                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" [disabled]="!busForm.valid" (click)="addBus()" class="btn btn-primary"
              ngbAutofocus>{{ModalBtn}}</button>
            <button type="button" class="btn btn-default" data-dismiss="modal" #defaultClick
              (click)="modal.dismiss('Cross click')">Close</button>
          </div>
        </ng-template>
        <ng-template #confirmDialog let-modal>
          <div class="modal-header">
            <h5 class="ng-tns-c116-5"> Would you Like to Delete the Record??</h5>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-sm-12">
                <div class="form-material">
                  <div class="right-icon-control">
                    Would you Like to Delete the Record
                    <form [formGroup]="formConfirm" class="editForm" novalidate>
                      <input type="hidden" formControlName="id">
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" (click)="deleteRecord()" class="btn btn-primary" ngbAutofocus>Confirm Delete</button>
            <button type="button" class="btn btn-default" data-dismiss="modal" #defaultClick
              (click)="modal.dismiss('Cross click')">Cancel</button>
          </div>
        </ng-template>

        <ng-template #editSeat let-modal>
          <div class="modal-header">
            <h5 class="ng-tns-c116-5"> {{busRecord.name}} [{{busRecord.bus_number}}]</h5>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <form [formGroup]="busForm" class="editForm" novalidate>
            <div class="modal-body">
              <div class="row">

                <div class="row form-group col-sm-12">
                  <div class="col-md-3">

                    <ng-select [items]="seatLayouts" bindLabel="name" bindValue="id" placeholder="Choose Seat Layout"
                      formControlName="bus_seat_layout_id" [clearable]="false" (change)="getSeatLayout($event)">
                    </ng-select>
                    <span class="text-danger"
                      *ngIf="busForm.controls['bus_seat_layout_id'].touched && busForm.controls['bus_seat_layout_id'].hasError('required')">
                      Seat Layout is required! </span>

                  </div>
                  <div class="col-md-9">
                    <div formArrayName="bus_seat_layout_data" class="col-12">

                      <div class="row"
                        *ngFor="let layoutRow of busForm.controls.bus_seat_layout_data.controls; let layout_row=index;"
                        [formGroupName]="layout_row">
                        <div formArrayName="lowerBerth" class="col-12" style="display: flex;justify-content: center;">
                          <div
                            *ngFor="let layoutCol of layoutRow['controls'].lowerBerth['controls']; let layout_row=index;"
                            [formGroupName]="layout_row" style="width: 50px; float: left;  text-align: center;">
                            <!-- (change)="chooseSeat($event.target.checked,layoutCol.controls.seatType.value,layoutCol.controls.seatText.value,1)" -->
                            <label class="seatHolder">
                              <input type="checkbox" formControlName="seatChecked"
                                *ngIf="layoutCol.controls.seatType.value!=4">
                              <span class="seaterImage" *ngIf="layoutCol.controls.seatType.value==1"></span>
                              <span class="sleeperImage" *ngIf="layoutCol.controls.seatType.value==2"></span>
                              <span class="verticalImage" *ngIf="layoutCol.controls.seatType.value==3"></span>
                              <span class="blankImage" *ngIf="layoutCol.controls.seatType.value==4"></span>
                              <span
                                *ngIf="layoutCol.controls.seatType.value!=4">{{layoutCol.controls.seatText.value}}</span>

                            </label>
                          </div>
                        </div>

                        <div formArrayName="upperBerth" class="col-12" style="display: flex;justify-content: center;">
                          <div
                            *ngFor="let layoutCol of layoutRow['controls'].upperBerth['controls']; let layout_row=index;"
                            [formGroupName]="layout_row" style="width: 50px; float: left;  text-align: center;">

                            <label class="seatHolder">
                              <input type="checkbox" formControlName="seatChecked"
                                *ngIf="layoutCol.controls.seatType.value!=4">
                              <span class="seaterImage" *ngIf="layoutCol.controls.seatType.value==1"></span>
                              <span class="sleeperImage" *ngIf="layoutCol.controls.seatType.value==2"></span>
                              <span class="verticalImage" *ngIf="layoutCol.controls.seatType.value==3"></span>
                              <span class="blankImage" *ngIf="layoutCol.controls.seatType.value==4"></span>
                              <span
                                *ngIf="layoutCol.controls.seatType.value!=4">{{layoutCol.controls.seatText.value}}</span>

                            </label>
                          </div>
                        </div>
                      </div>

                    </div>

                  </div>

                </div>

              </div>
            </div>
          </form>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" (click)="updateSeatLayout()" ngbAutofocus>Update Seat
              Layout</button>
            <button type="button" class="btn btn-default" data-dismiss="modal" #defaultClick
              (click)="modal.dismiss('Cross click')">Cancel</button>
          </div>
        </ng-template>

        <ng-template #editExtraSeatLayout let-modal>
          <div class="modal-header">
            <h5 class="ng-tns-c116-5"> {{busRecord.name}} [{{busRecord.bus_number}}]</h5>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <form [formGroup]="busForm" class="editForm" novalidate>
            <div class="modal-body">
              <div class="row">

                <div class="row form-group col-sm-12">
                  <div class="col-4 input-group">
                    <input type="text" required  class="form-control" formControlName="duration_minuties"
                      placeholder="Duration in Minutes">
                    <div class="input-group-append">
                      <span class="input-group-text" id="basic-addon2">Minutes</span>
                    </div>
                  </div>
                  <div class="col-12">
                    <span class="text-danger"
                      *ngIf="busForm.controls['duration_minuties'].touched && busForm.controls['duration_minuties'].hasError('required')">
                      Duration is required! </span>
                  </div>
                </div>
                <div class="row form-group col-sm-12">
                  <div class="col-md-3">

                    <ng-select [items]="seatLayouts" bindLabel="name" bindValue="id" placeholder="Choose Seat Layout"
                      formControlName="bus_seat_layout_id" [clearable]="false" (change)="getSeatLayout($event)">
                    </ng-select>
                    <span class="text-danger"
                      *ngIf="busForm.controls['bus_seat_layout_id'].touched && busForm.controls['bus_seat_layout_id'].hasError('required')">
                      Seat Layout is required! </span>

                  </div>
                  <div class="col-md-9">
                    <div formArrayName="bus_seat_layout_data" class="col-12">

                      <div class="row"
                        *ngFor="let layoutRow of busForm.controls.bus_seat_layout_data.controls; let layout_row=index;"
                        [formGroupName]="layout_row">
                        <div formArrayName="lowerBerth" class="col-12" style="display: flex;justify-content: center;">
                          <div
                            *ngFor="let layoutCol of layoutRow['controls'].lowerBerth['controls']; let layout_row=index;"
                            [formGroupName]="layout_row" style="width: 50px; float: left;  text-align: center;">
                            <!-- (change)="chooseSeat($event.target.checked,layoutCol.controls.seatType.value,layoutCol.controls.seatText.value,1)" -->
                            <label class="seatHolder">
                              <input type="checkbox" formControlName="seatChecked"
                                *ngIf="layoutCol.controls.seatType.value!=4">
                              <span class="seaterImage" *ngIf="layoutCol.controls.seatType.value==1"></span>
                              <span class="sleeperImage" *ngIf="layoutCol.controls.seatType.value==2"></span>
                              <span class="verticalImage" *ngIf="layoutCol.controls.seatType.value==3"></span>
                              <span class="blankImage" *ngIf="layoutCol.controls.seatType.value==4"></span>
                              <span
                                *ngIf="layoutCol.controls.seatType.value!=4">{{layoutCol.controls.seatText.value}}</span>

                            </label>
                          </div>
                        </div>

                        <div formArrayName="upperBerth" class="col-12" style="display: flex;justify-content: center;">
                          <div
                            *ngFor="let layoutCol of layoutRow['controls'].upperBerth['controls']; let layout_row=index;"
                            [formGroupName]="layout_row" style="width: 50px; float: left;  text-align: center;">

                            <label class="seatHolder">
                              <input type="checkbox" formControlName="seatChecked"
                                *ngIf="layoutCol.controls.seatType.value!=4">
                              <span class="seaterImage" *ngIf="layoutCol.controls.seatType.value==1"></span>
                              <span class="sleeperImage" *ngIf="layoutCol.controls.seatType.value==2"></span>
                              <span class="verticalImage" *ngIf="layoutCol.controls.seatType.value==3"></span>
                              <span class="blankImage" *ngIf="layoutCol.controls.seatType.value==4"></span>
                              <span
                                *ngIf="layoutCol.controls.seatType.value!=4">{{layoutCol.controls.seatText.value}}</span>

                            </label>
                          </div>
                        </div>
                      </div>

                    </div>

                  </div>

                </div>

              </div>
            </div>
          </form>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" (click)="updateExtraSeatLayout()" [disabled]="!busForm.valid"
              ngbAutofocus>Update Seat Layout</button>
            <button type="button" class="btn btn-default" data-dismiss="modal" #defaultClick
              (click)="modal.dismiss('Cross click')">Cancel</button>
          </div>
        </ng-template>
        <button type="button" #addnew class="btn btn-primary btn-add-task m-t-10 invisible" id="modal"
          (click)="ResetAttributes();LoadAllService();OpenModal(wizardContent);">Add </button>
        <ng-template #wizardContent let-modal>
          <div class="modal-header">
            <h5 class="ng-tns-c116-5" id="boxheading">{{ModalHeading}}</h5>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-sm-12">
                <div class="form-material">
                  <div class="right-icon-control">
                    <form [formGroup]="busForm" class="editForm" novalidate>

                      <aw-wizard #wizard class="arc-wizard arc-custom" navBarLayout="large-filled-symbols">
                        <aw-wizard-step stepTitle="Bus Info"
                          [navigationSymbol]="{ symbol: '&#xe8e9;', fontFamily: 'feather' }" [style.font-weight]="900">
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group row">

                                <label for="bus" class="col-sm-4 col-form-label">Operator <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="operators" bindLabel="operatorData" bindValue="id"
                                    placeholder="Select Operator" formControlName="bus_operator_id" [clearable]="false">
                                  </ng-select>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['bus_operator_id'].touched && busForm.controls['bus_operator_id'].hasError('required')">
                                    Operator Name is required! </span>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Bus Name <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">

                                  <input type="text" class="form-control" placeholder="Enter Bus name" required
                                    formControlName="name" [value]="busRecord.name" />
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['name'].touched && busForm.controls['name'].hasError('required')">
                                    Bus name is required! </span>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Via <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <input type="text" class="form-control" placeholder="Enter via" required
                                    formControlName="via" [value]="busRecord.via" />
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['via'].touched && busForm.controls['via'].hasError('required')">
                                    Via is required! </span>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">

                           
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Bus Number<span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <!-- [value]="busRecord.bus_number1" alt+z-->
                                  <input type="text" class="form-control text-uppercase" placeholder="Enter Bus Number"
                                    formControlName="bus_number" />
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.bus_number.touched && busForm.controls.bus_number.hasError('required')">
                                    Bus Number is required! </span>
                                </div>

                              </div>
                              
                            </div>
                            
                          </div>
                          <div class="row">
                            <div class="col-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Amenities <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="amenities" [multiple]="true" bindLabel="name" bindValue="id"
                                    placeholder="Choose Amenities" formControlName="amenities" [clearable]="false">
                                  </ng-select>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['amenities'].touched && busForm.controls['amenities'].hasError('required')">
                                    Amenities is required! </span>
                                </div>
                              </div>
                            </div>

                            <div class="col-6">
                              <!-- <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Bus Safety</label>
                                <div class="col-sm-8">
                                  <ng-select [items]="safetyies" [multiple]="true" bindLabel="name" bindValue="id"
                                    placeholder="Choose Safety" formControlName="safety" [clearable]="false">
                                  </ng-select>

                                </div>
                              </div> -->
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Bus Safety <span
                                  class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="safetyies" [multiple]="true" bindLabel="name" bindValue="id"
                                    placeholder="Choose Safety" formControlName="safety" [clearable]="false">
                                  </ng-select>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['safety'].touched && busForm.controls['safety'].hasError('required')">
                                    Safety is required! </span>

                                </div>
                              </div>
                            </div>


                          </div>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Seating Type <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="busSeatingTypes" bindLabel="name" bindValue="id"
                                    placeholder="Choose Seating Type" formControlName="bus_sitting_id"
                                    [clearable]="false">
                                  </ng-select>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['bus_sitting_id'].touched && busForm.controls['bus_sitting_id'].hasError('required')">
                                    Seating Type is required! </span>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Display Info</label>
                                <div class="col-sm-8">
                                  <input type="text" class="form-control" formControlName="bus_description" />

                                </div>
                              </div>
                            </div>

                          </div>

                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Cancellation Points</label>
                                <div class="col-sm-8">
                                  <input type="text" class="form-control" placeholder="cancellation additional points"
                                    formControlName="cancelation_points" [value]="busRecord.cancelation_points" />
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Max Seat Book<span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <input type="text" class="form-control" formControlName="max_seat_book">
                                </div>
                              </div>

                            </div>
                          </div>

                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Cancellation Slab <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="cancellationslabs" bindLabel="rule_name" bindValue="id"
                                    placeholder="Choose Cancellation Slab" formControlName="cancellationslabs_id"
                                    [clearable]="false" (change)="getCancellationRule($event)">
                                  </ng-select>

                                  <span class="text-danger"
                                    *ngIf="busForm.controls['cancellationslabs_id'].touched && busForm.controls['cancellationslabs_id'].hasError('required')">
                                    Cancellation Slab is required! </span>


                                </div>
                              </div>


                            </div>
                            <div class="col-md-6">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-4 col-form-label">Bus Type <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-8">
                                  <ng-select [items]="busTypes" bindLabel="name" bindValue="id"
                                    placeholder="Choose Bus Type" formControlName="bus_type_id" [clearable]="false">
                                  </ng-select>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls['bus_type_id'].touched && busForm.controls['bus_type_id'].hasError('required')">
                                    Bus Type is required! </span>
                                </div>
                              </div>
                            </div>                           
                          </div>
                          <div class="row">
                       
                                <div class="col-md-6">
                                  <div class="row form-group">
                                    <div class="col-6" *ngIf="allDurations?.length > 0" style="font-size: 12px;">
                                      <strong>Hours before Dep:</strong>
                                      <div *ngFor="let cSlabduration of allDurations; let durationIndex=index;"
                                        style="border-bottom: 1px solid #000;">
                                        <strong>{{durationIndex+1}}</strong>. {{ cSlabduration.duration}}
                                      </div>
                                    </div>
                                    <div class="col-6" *ngIf="allDurations?.length > 0" style="font-size: 12px;">
                                      <strong>Cancellation Charges:</strong>
                                      <div *ngFor="let cSlabdeduction of allDurations; let deductionIndex=index;"
                                        style="border-bottom: 1px solid #000;"><strong>{{deductionIndex+1}}</strong>. {{
                                        cSlabdeduction.deduction}} %</div>
                                    </div>
    
                                  </div>
                                </div>
                              
                          </div>
                          <div class="row">

                            <div class="col-sm-12 centered-content">
                              <div class="btn-group mt-10">
                                <button type="button" class="btn btn-primary btn-sm" awNextStep>Continue</button>
                              </div>
                            </div>
                          </div>

                        </aw-wizard-step>
                        <aw-wizard-step stepTitle="Layout"
                          [navigationSymbol]="{ symbol: '&#xe88c;', fontFamily: 'feather' }" [style.font-weight]="900">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="form-group row">
                                <label for="bus" class="col-sm-2 col-form-label">Seat Layout <span
                                    class="text-danger">*</span></label>
                                <div class="col-sm-4">
                                  <ng-select [items]="seatLayouts" bindLabel="name" bindValue="id"
                                    placeholder="Choose Seat Layout" formControlName="bus_seat_layout_id"
                                    [clearable]="false" (change)="getSeatLayout($event)">
                                  </ng-select>

                                  <span class="text-danger"
                                    *ngIf="busForm.controls['bus_seat_layout_id'].touched && busForm.controls['bus_seat_layout_id'].hasError('required')">
                                    Seat Layout is required! </span>
                                </div>
                                <div formArrayName="bus_seat_layout_data" class="col-12">

                                  <div class="row"
                                    *ngFor="let layoutRow of busForm.controls.bus_seat_layout_data.controls; let layout_row=index;"
                                    [formGroupName]="layout_row">
                                    <div formArrayName="lowerBerth" class="col-12"
                                      style="display: flex;justify-content: center;">
                                      <div
                                        *ngFor="let layoutCol of layoutRow['controls'].lowerBerth['controls']; let layout_row=index;"
                                        [formGroupName]="layout_row"
                                        style="width: 50px; float: left;  text-align: center;">
                                        <!-- (change)="chooseSeat($event.target.checked,layoutCol.controls.seatType.value,layoutCol.controls.seatText.value,1)" -->
                                        <label class="seatHolder">
                                          <input type="checkbox" formControlName="seatChecked"
                                            *ngIf="layoutCol.controls.seatType.value!=4">
                                          <span class="seaterImage" *ngIf="layoutCol.controls.seatType.value==1"></span>
                                          <span class="sleeperImage"
                                            *ngIf="layoutCol.controls.seatType.value==2"></span>
                                          <span class="verticalImage"
                                            *ngIf="layoutCol.controls.seatType.value==3"></span>
                                          <span class="blankImage" *ngIf="layoutCol.controls.seatType.value==4"></span>
                                          <span
                                            *ngIf="layoutCol.controls.seatType.value!=4">{{layoutCol.controls.seatText.value}}</span>

                                        </label>
                                      </div>
                                    </div>

                                    <div formArrayName="upperBerth" class="col-12"
                                      style="display: flex;justify-content: center;">
                                      <div
                                        *ngFor="let layoutCol of layoutRow['controls'].upperBerth['controls']; let layout_row=index;"
                                        [formGroupName]="layout_row"
                                        style="width: 50px; float: left;  text-align: center;">

                                        <label class="seatHolder">
                                          <input type="checkbox" formControlName="seatChecked"
                                            *ngIf="layoutCol.controls.seatType.value!=4">
                                          <span class="seaterImage" *ngIf="layoutCol.controls.seatType.value==1"></span>
                                          <span class="sleeperImage"
                                            *ngIf="layoutCol.controls.seatType.value==2"></span>
                                          <span class="verticalImage"
                                            *ngIf="layoutCol.controls.seatType.value==3"></span>
                                          <span class="blankImage" *ngIf="layoutCol.controls.seatType.value==4"></span>
                                          <span
                                            *ngIf="layoutCol.controls.seatType.value!=4">{{layoutCol.controls.seatText.value}}</span>

                                        </label>
                                      </div>
                                    </div>
                                  </div>

                                </div>

                              </div>
                            </div>
                            <div class="col-sm-12 centered-content">
                              <div class="btn-group mt-10">
                                <button type="button" class="btn btn-secondary btn-sm" awPreviousStep>Back</button>
                                <button type="button" class="btn btn-primary btn-sm" awNextStep>Continue</button>
                              </div>
                            </div>
                          </div>

                        </aw-wizard-step>
                        <aw-wizard-step stepTitle="Contact Info"
                          [navigationSymbol]="{ symbol: '&#xe848;', fontFamily: 'feather' }"
                          navigationSymbolFontFamily="Font Awesome\ 5 Free" [style.font-weight]="900">

                          <div class="form-group" style="font-weight:bold">Contact Information For Bus</div>
                          <div class="col-12">
                            <div class="col-12">                            
                              <!-- start -->
                              <div class="form-group row">
                                <label for="bus" class="col-sm-3 col-form-label">Lable </label>
                                <label for="bus" class="col-sm-4 col-form-label">Contact Number </label>
                                <label for="bus" class="col-sm-2 col-form-label">SMS On Ticket </label>
                                <label for="bus" class="col-sm-3 col-form-label">SMS On Cancellation </label>
                              </div>

                              <div class="form-group row">
                                <label for="bus" class="col-sm-3 ">Conductor</label>
                                <div class="col-sm-4 ">
                                  <input type="text" class="form-control" placeholder="Enter Mobile No"
                                    formControlName="conductor_no" />
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.conductor_no.touched && busForm.controls.conductor_no.hasError('required')">
                                    Contact Number is Required
                                  </span>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.conductor_no.touched && busForm.controls.conductor_no.hasError('minlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.conductor_no.touched && busForm.controls.conductor_no.hasError('maxlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger" *ngIf="busForm.controls.conductor_no.errors?.pattern">
                                    Enter only Digits
                                  </span>
                                </div>
                                <div class="col-sm-2 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitch1{{k}}"
                                      formControlName="c_sms_ticket">
                                    <label class="custom-control-label" for="customswitch1{{k}}"></label>
                                  </div>
                                </div>
                                <div class="col-sm-3 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitch2{{k}}"
                                      formControlName="c_sms_cancel">
                                    <label class="custom-control-label" for="customswitch2{{k}}"></label>
                                  </div>
                                </div>
                              </div>

                              <div class="form-group row">
                                <label for="bus" class="col-sm-3 ">Manager</label>
                                <div class="col-sm-4 ">
                                  <input type="text" class="form-control" placeholder="Enter Mobile No"
                                    formControlName="manager_no" />
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.manager_no.touched && busForm.controls.manager_no.hasError('required')">
                                    Contact Number is Required
                                  </span>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.manager_no.touched && busForm.controls.manager_no.hasError('minlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.manager_no.touched && busForm.controls.manager_no.hasError('maxlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger" *ngIf="busForm.controls.manager_no.errors?.pattern">
                                    Enter only Digits
                                  </span>
                                </div>
                                <div class="col-sm-2 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitcha{{k}}"
                                      formControlName="m_sms_ticket">
                                    <label class="custom-control-label" for="customswitcha{{k}}"></label>
                                  </div>
                                </div>
                                <div class="col-sm-3 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitchb{{k}}"
                                      formControlName="m_sms_cancel">
                                    <label class="custom-control-label" for="customswitchb{{k}}"></label>
                                  </div>
                                </div>
                              </div>

                              <div class="form-group row">
                                <label for="bus" class="col-sm-3 ">Owner</label>
                                <div class="col-sm-4 ">
                                  <input type="text" class="form-control" placeholder="Enter Mobile No"
                                    formControlName="owner_no" />

                                  <span class="text-danger"
                                    *ngIf="busForm.controls.owner_no.touched && busForm.controls.owner_no.hasError('required')">
                                    Contact Number is Required
                                  </span>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.owner_no.touched && busForm.controls.owner_no.hasError('minlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger"
                                    *ngIf="busForm.controls.owner_no.touched && busForm.controls.owner_no.hasError('maxlength')">
                                    10 Digit Number is Required
                                  </span>
                                  <span class="text-danger" *ngIf="busForm.controls.owner_no.errors?.pattern">
                                    Enter only Digits
                                  </span>

                                </div>
                                <div class="col-sm-2 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitch5{{k}}"
                                      formControlName="o_sms_ticket">
                                    <label class="custom-control-label" for="customswitch5{{k}}"></label>
                                  </div>
                                </div>
                                <div class="col-sm-3 ">
                                  <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="customswitch7{{k}}"
                                      formControlName="o_sms_cancel">
                                    <label class="custom-control-label" for="customswitch7{{k}}"></label>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="col-sm-12 centered-content">
                              <div class="btn-group mt-10">
                                <button type="button" class="btn btn-secondary btn-sm" awPreviousStep>Back</button>
                                <button type="button" class="btn btn-primary btn-sm" awNextStep>Continue</button>
                              </div>
                            </div>
                          </div>

                        </aw-wizard-step>
                        <aw-wizard-step stepTitle="Config Location"
                          [navigationSymbol]="{ symbol: '&#xe861;', fontFamily: 'feather' }"
                          navigationSymbolFontFamily="Font Awesome\ 5 Free" [style.font-weight]="900">

                          <div formArrayName="busRoutes">
                            <div class="row">
                              <div class="col-6" *ngFor="let singleRoute of routeFormGroup.controls; let i = index;">
                                <div [formGroupName]="i" class="row">
                                  <div class="form-group col-5">
                                    <label>Location and Time <span class="text-danger">*</span></label>
                                    <ng-select [items]="locations" bindLabel="name" bindValue="id"
                                      placeholder="Select Location" formControlName="source_id"
                                      (change)="getSource($event,i)" [clearable]="false">
                                    </ng-select>

                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.source_id.touched && singleRoute.controls.source_id.hasError('required')">
                                      Source is required! </span>


                                  </div>

                                  <div class="form-group col-md-3">
                                    <label>Time <span class="text-danger">*</span></label>
                                    <input type="time" formControlName="location_time" class="form-control">
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.location_time.touched && singleRoute.controls.location_time.hasError('required')">
                                      Location Time is required! </span>
                                  </div>

                                  <div class="form-group col-md-2">
                                    <label>Seq <span class="text-danger">*</span></label>
                                    <input type="text" formControlName="sequence" class="form-control">
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.sequence.touched && singleRoute.controls.sequence.hasError('required')">
                                      Sequence is required! </span>
                                  </div>
                                  <div class="col-md-1 text-right">
                                    <button class="btn btn-danger btn-sm" type="button" (click)="removeRoute(i)"
                                      style="margin-top: 26px;"> X </button>
                                  </div>
                                  <div class="form-group col-12">
                                    <ng-container formArrayName="sourceBoarding">
                                      <ng-container
                                        *ngFor="let sourceBoardingFormGroup of singleRoute['controls'].sourceBoarding['controls']; let sourceCounts = index">
                                        <div formGroupName="{{sourceCounts}}">

                                          <div class="formgroup row" style="margin-top:10px">
                                            <div class="col-md-1 form-check">

                                              <input type="checkbox" id="source-{{i}}{{sourceCounts}}" [checked]="false"
                                                formControlName="sourcechecked">

                                            </div>
                                            <div class="col-md-6">
                                              <label
                                                for="source-{{i}}{{sourceCounts}}">{{sourceBoardingFormGroup.controls.sourceLocation.value}}</label>

                                            </div>
                                            <div class="col-md-5">
                                              <input type="time" formControlName="sourceTime"
                                                class="form-control required" placeholder="Date" atp-time-picker
                                                value="20:55" onlyHour="true" onlyAM='true'>
                                            </div>
                                          </div>
                                        </div>

                                      </ng-container>
                                    </ng-container>
                                  </div>




                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row form-group">
                            <div class="col-12 text-right"><button class="btn btn-primary btn-sm" type="button"
                                (click)="addRoute()"> Add Location +</button></div>
                          </div>
                          <div class="col-sm-12 centered-content">
                            <div class="btn-group mt-10">
                              <button type="button" class="btn btn-secondary btn-sm" awPreviousStep>Back</button>
                              <button type="button" class="btn btn-primary btn-sm" awNextStep>Continue</button>
                            </div>
                          </div>
                        </aw-wizard-step>
                        <aw-wizard-step stepTitle="Completed"
                          [navigationSymbol]="{ symbol: '&#xe840;', fontFamily: 'feather' }" [style.font-weight]="900">
                          <div class="row">
                            <div formArrayName="busRoutesInfo" class="col-12">
                              <div class="col-12"
                                *ngFor="let singleRoute of routeInfoFormGroup.controls; let i = index;">
                                <div [formGroupName]="i" class="row">
                                  <div class="form-group col-2" style="padding:0px 5px;">
                                    <label>From <span class="text-danger">*</span></label>
                                    <select class="form-control" required formControlName="from_location" type="text">
                                      <option value="" selected>Choose Location</option>
                                      <option *ngFor="let fromLocation of selectedLocations; let from_lc=index;"
                                        [value]="fromLocation[0].id">{{fromLocation[0].location_name}}</option>
                                    </select>
                                  </div>
                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="bus">On Day</label>
                                    <select class="form-control" formControlName="arr_days" type="text" placement="top"
                                      ngbTooltip="Days">
                                      <option value="1" selected>1</option>
                                      <option value="2">2</option>
                                      <option value="3">3</option>
                                      <option value="4">4</option>
                                      <option value="5">5</option>
                                    </select>
                                  </div>
                                  <div class="form-group col-2" style="padding:0px 5px;">
                                    <label>To <span class="text-danger">*</span></label>
                                    <select class="form-control" required formControlName="to_location" type="text">
                                      <option value="" selected>Choose Location</option>
                                      <option *ngFor="let toLocation of selectedLocations; let to_lc=index;"
                                        [value]="toLocation[0].id">{{toLocation[0].location_name}}</option>
                                    </select>
                                  </div>
                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="bus">On Day</label>
                                    <select class="form-control" formControlName="dep_days" type="text" placement="top"
                                      ngbTooltip="Days">
                                      <option value="1" selected>1</option>
                                      <option value="2">2</option>
                                      <option value="3">3</option>
                                      <option value="4">4</option>
                                      <option value="5">5</option>
                                    </select>
                                  </div>
                                  <div class="form-group col-md-1 " style="padding:0px 5px;">
                                    <label for="bus">Seat Fare<span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" required formControlName="seater_fare"
                                      [value]="busRecord.seater_fare" placeholder="Seater Fare" placement="top"
                                      ngbTooltip="Seater Fare" />
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.seater_fare.touched && singleRoute.controls.seater_fare.hasError('required')">
                                      Seater Fare is required! </span>
                                  </div>
                                  <div class="form-group col-md-1 " style="padding:0px 5px;">
                                    <label for="bus">Sleeper Fare<span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" required formControlName="sleeper_fare"
                                      [value]="busRecord.sleeper_fare" placeholder="Sleeper Fare" placement="top"
                                      ngbTooltip="Sleeper Fare" />
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.sleeper_fare.touched && singleRoute.controls.sleeper_fare.hasError('required')">
                                      Sleeper Fare is required! </span>
                                  </div>
                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="bus">Seize Time</label>
                                    <input type="text" class="form-control" required formControlName="booking_seized"
                                      [value]="busRecord.booking_seized" placeholder="Enter minute" placement="top"
                                      ngbTooltip="Enter minute here1" (input)="getActualtime(i);"/>
                                     
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.booking_seized.touched && singleRoute.controls.booking_seized.hasError('required')">
                                      Seize Time is required! </span>
                                  </div>

                                  <div class="form-group col-md-2" style="padding:0px 5px;">
                                    <label for="bus">Actual Time</label>
                                    <input type="time" readonly class="form-control" required formControlName="actual_time" placement="top"/>
                                     
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.actual_time.touched && singleRoute.controls.actual_time.hasError('required')">
                                     Actual Time is required! </span>
                                  </div>

                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="route_status">Status</label>
                                    <div class="custom-control custom-switch">
                                      <input type="checkbox" class="custom-control-input" id="route_status{{i}}" formControlName="route_status">
                                      <label class="custom-control-label" for="route_status{{i}}"></label>
                                      <button class="btn btn-danger btn-sm" type="button" (click)="removeRouteInfo(i)"> X </button>
                                    </div>

                                  </div>
                                  <!-- (click)="removeRoute(i)"  -->
                                  <!-- <div class="form-group col-md-1 text-right" style="padding:0px 5px;">
                                    <label>&nbsp;</label>
                                    
                                  </div> -->


                                </div>
                              </div>
                            </div>
                            <div class="col-12">
                              <div class="row form-group">
                                <div class="col-12 text-right"><button class="btn btn-primary btn-sm" type="button"
                                    (click)="addRouteInfo()"> Add New Route +</button></div>
                              </div>
                            </div>

                            <div class="col-sm-12 centered-content">
                              <div class="btn-group mt-10">
                                <button type="button" class="btn btn-secondary btn-sm" awPreviousStep>Back</button>
                                <button type="button" class="btn btn-success btn-sm" awResetWizard>Finished</button>
                              </div>
                            </div>
                          </div>
                        </aw-wizard-step>
                      </aw-wizard>


                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">


            <button type="button" [disabled]="!busForm.valid" (click)="addBus()" class="btn btn-primary"
              ngbAutofocus>{{ModalBtn}}</button>
            <button type="button" class="btn btn-default" data-dismiss="modal" #defaultClick
              (click)="modal.dismiss('Cross click')">Close</button>
          </div>
        </ng-template>

        <ng-template #editcontent let-modal>
          <div class="modal-header">
            <h5 class="ng-tns-c116-5" id="boxheading">{{ModalHeading}}</h5>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-sm-12">
                <div class="form-material">
                  <div class="right-icon-control">
                    <form [formGroup]="busForm" class="editForm" novalidate>
                      <div class="row">
                        <div class="col-md-6">
                          <div class="form-group row">
                            <input type="hidden" formControlName="id" />
                            <label for="bus" class="col-sm-4 col-form-label">Operator <span
                                class="text-danger">*</span></label>
                            <div class="col-sm-8">
                              <ng-select [items]="operators" bindLabel="operatorData" bindValue="id"
                                placeholder="Choose Operator" formControlName="bus_operator_id" [clearable]="false">
                              </ng-select>

                              <span class="text-danger"
                                *ngIf="busForm.controls['bus_operator_id'].touched && busForm.controls['bus_operator_id'].hasError('required')">
                                Operator Name is required! </span>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Bus Name <span
                                class="text-danger">*</span></label>
                            <div class="col-sm-8">

                              <input type="text" class="form-control" placeholder="Enter Bus name" required
                                formControlName="name" [value]="busRecord.name" />
                              <span class="text-danger"
                                *ngIf="busForm.controls['name'].touched && busForm.controls['name'].hasError('required')">
                                Bus name is required! </span>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-6">
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Via <span
                                class="text-danger">*</span></label>
                            <div class="col-sm-8">
                              <input type="text" class="form-control" placeholder="Enter via" required
                                formControlName="via" [value]="busRecord.via" />
                              <span class="text-danger"
                                *ngIf="busForm.controls['via'].touched && busForm.controls['via'].hasError('required')">
                                Via is required! </span>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Bus Number <span class="text-danger">*</span>
                            </label>
                            <div class="col-sm-8">
                              <!-- [value]="busRecord.bus_number1" alt+z-->
                              <input type="text" class="form-control text-uppercase" placeholder="Enter Bus Number"
                                formControlName="bus_number" />
                              <span class="text-danger"
                                *ngIf="busForm.controls.bus_number.touched && busForm.controls.bus_number.hasError('required')">
                                Bus Number is required! </span>
                            </div>
                          </div>                       
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-6">
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Amenities <span
                                class="text-danger">*</span></label>
                            <div class="col-sm-8">
                              <ng-select [items]="amenities" [multiple]="true" bindLabel="name" bindValue="id"
                                placeholder="Choose Amenities" formControlName="amenities" [clearable]="false">
                              </ng-select>
                              <span class="text-danger"
                                *ngIf="busForm.controls['amenities'].touched && busForm.controls['amenities'].hasError('required')">
                                Amenities is required! </span>
                            </div>
                          </div>
                        </div>
                        <div class="col-6">

                          <!-- <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Bus Safety</label>
                            <div class="col-sm-8">
                              <ng-select [items]="safetyies" [multiple]="true" bindLabel="name" bindValue="id"
                                placeholder="Choose Safety" formControlName="safety" [clearable]="false">
                              </ng-select>

                            </div>
                          </div> -->
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Bus Safety <span
                              class="text-danger">*</span></label>
                            <div class="col-sm-8">
                              <ng-select [items]="safetyies" [multiple]="true" bindLabel="name" bindValue="id"
                                placeholder="Choose Safety" formControlName="safety" [clearable]="false">
                              </ng-select>
                              <span class="text-danger"
                                *ngIf="busForm.controls['safety'].touched && busForm.controls['safety'].hasError('required')">
                                Safety is required! </span>

                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-6">
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Seating Type <span
                                class="text-danger">*</span></label>
                            <div class="col-sm-8">
                              <ng-select [items]="busSeatingTypes" bindLabel="name" bindValue="id"
                                placeholder="Choose Seating Type" formControlName="bus_sitting_id" [clearable]="false">
                              </ng-select>

                              <span class="text-danger"
                                *ngIf="busForm.controls['bus_sitting_id'].touched && busForm.controls['bus_sitting_id'].hasError('required')">
                                Seating Type is required! </span>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Display Info</label>
                            <div class="col-sm-8">
                              <input type="text" class="form-control" formControlName="bus_description" />

                            </div>
                          </div>
                        </div>


                      </div>
                      <div class="row">
                        <div class="col-md-6">
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Cancellation points</label>
                            <div class="col-sm-8">
                              <input type="text" class="form-control" placeholder="cancellation additional points"
                                formControlName="cancelation_points" [value]="busRecord.cancelation_points" />
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Max Seat Book<span
                                class="text-danger">*</span></label>
                            <div class="col-sm-8">
                              <input type="text" class="form-control" formControlName="max_seat_book">
                            </div>
                          </div>

                        </div>





                      </div>
                      <div class="row">

                        <div class="col-md-6">
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Cancellation Rules <span
                                class="text-danger">*</span></label>
                            <div class="col-sm-8">
                              <ng-select [items]="cancellationslabs" bindLabel="rule_name" bindValue="id"
                                placeholder="Choose Cancellation Slab" formControlName="cancellationslabs_id"
                                [clearable]="false" (change)="getCancellationRule($event)">
                              </ng-select>


                              <span class="text-danger"
                                *ngIf="busForm.controls['cancellationslabs_id'].touched && busForm.controls['cancellationslabs_id'].hasError('required')">
                                Cancellation Slab is required! </span>


                            </div>

                          </div>

                        </div>
                        <div class="col-md-6">
                          <div class="form-group row">
                            <label for="bus" class="col-sm-4 col-form-label">Bus Type <span
                                class="text-danger">*</span></label>
                            <div class="col-sm-8">
                              <ng-select [items]="busTypes" bindLabel="name" bindValue="id"
                                placeholder="Choose Bus Type" formControlName="bus_type_id" [clearable]="false">
                              </ng-select>


                              <span class="text-danger"
                                *ngIf="busForm.controls['bus_type_id'].touched && busForm.controls['bus_type_id'].hasError('required')">
                                Bus Type is required! </span>
                            </div>
                          </div>                        
                        </div>
                      </div>
                      <div class="row">
                          <div class="col-md-6">
                            <div class="row form-group">
                              <div class="col-6" *ngIf="allDurations?.length > 0"
                                style="margin-top: 20px; font-size: 12px;">
                                <strong>Hours before Dep:</strong>
                                <div *ngFor="let cSlabduration of allDurations; let durationIndex=index;"
                                  style="border-bottom: 1px solid #000;">
                                  <strong>{{durationIndex+1}}</strong>. {{ cSlabduration.duration}}
                                </div>
                              </div>
                              <div class="col-6" *ngIf="allDurations?.length > 0"
                                style="margin-top: 20px; font-size: 12px;">
                                <strong>Cancellation Charges:</strong>
                                <div *ngFor="let cSlabdeduction of allDurations; let deductionIndex=index;"
                                  style="border-bottom: 1px solid #000;"><strong>{{deductionIndex+1}}</strong>. {{
                                  cSlabdeduction.deduction}} %</div>
                              </div>
  
                            </div>
                          </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" [disabled]="!busForm.valid" (click)="updateGeneralInfo()" class="btn btn-primary"
              ngbAutofocus>{{ModalBtn}}</button>
            <button type="button" class="btn btn-default" data-dismiss="modal" #defaultClick
              (click)="modal.dismiss('Cross click')">Close</button>
          </div>
        </ng-template>

        <ng-template #contactinfo let-modal>
          <div class="modal-header">
            <h5 class="ng-tns-c116-5" id="boxheading">{{ModalHeading}}</h5>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-sm-12">
                <div class="form-material">
                  <div class="right-icon-control">
                    <form [formGroup]="busForm" class="editForm" novalidate>
                      <input type="hidden" formControlName="id">
                      <div class="col-12">
                        <div class="form-group row">
                          <label for="bus" class="col-sm-3 col-form-label">Bus Number <span class="text-danger">*</span>
                          </label>
                          <div class="col-sm-4">
                            <!-- [value]="busRecord.bus_number1" alt+z-->
                            <input type="text" class="form-control text-uppercase" placeholder="Enter Bus Number"
                              formControlName="bus_number" readonly/>
                            <span class="text-danger"
                              *ngIf="busForm.controls.bus_number.touched && busForm.controls.bus_number.hasError('required')">
                              Bus Number is required! </span>
                          </div>
                        </div>
                        <!-- start -->
                        <div class="form-group row">
                          <label for="bus" class="col-sm-3 col-form-label">Lable </label>
                          <label for="bus" class="col-sm-4 col-form-label">Contact Number </label>
                          <label for="bus" class="col-sm-2 col-form-label">SMS On Ticket </label>
                          <label for="bus" class="col-sm-3 col-form-label">SMS On Cancellation </label>
                        </div>

                        <div class="form-group row">
                          <label for="bus" class="col-sm-3 ">Conductor</label>
                          <div class="col-sm-4 ">
                            <input type="text" class="form-control" placeholder="Enter Mobile No" 
                              formControlName="conductor_no" />
                          </div>
                          <div class="col-sm-2 ">
                            <div class="custom-control custom-switch">
                              <input type="checkbox" class="custom-control-input" id="customswitch1{{k}}"
                                formControlName="c_sms_ticket">
                              <label class="custom-control-label" for="customswitch1{{k}}"></label>
                            </div>
                          </div>
                          <div class="col-sm-3 ">
                            <div class="custom-control custom-switch">
                              <input type="checkbox" class="custom-control-input" id="customswitch2{{k}}"
                                formControlName="c_sms_cancel">
                              <label class="custom-control-label" for="customswitch2{{k}}"></label>
                            </div>
                          </div>
                        </div>

                        <div class="form-group row">
                          <label for="bus" class="col-sm-3 ">Manager</label>
                          <div class="col-sm-4 ">
                            <input type="text" class="form-control" placeholder="Enter Mobile No" 
                              formControlName="manager_no" />
                          </div>
                          <div class="col-sm-2 ">
                            <div class="custom-control custom-switch">
                              <input type="checkbox" class="custom-control-input" id="customswitcha{{k}}"
                                formControlName="m_sms_ticket">
                              <label class="custom-control-label" for="customswitcha{{k}}"></label>
                            </div>
                          </div>
                          <div class="col-sm-3 ">
                            <div class="custom-control custom-switch">
                              <input type="checkbox" class="custom-control-input" id="customswitchb{{k}}"
                                formControlName="m_sms_cancel">
                              <label class="custom-control-label" for="customswitchb{{k}}"></label>
                            </div>
                          </div>
                        </div>

                        <div class="form-group row">
                          <label for="bus" class="col-sm-3 ">Owner</label>
                          <div class="col-sm-4 ">
                            <input type="text" class="form-control" placeholder="Enter Mobile No" 
                              formControlName="owner_no" />
                          </div>
                          <div class="col-sm-2 ">
                            <div class="custom-control custom-switch">
                              <input type="checkbox" class="custom-control-input" id="customswitch5{{k}}"
                                formControlName="o_sms_ticket">
                              <label class="custom-control-label" for="customswitch5{{k}}"></label>
                            </div>
                          </div>
                          <div class="col-sm-3 ">
                            <div class="custom-control custom-switch">
                              <input type="checkbox" class="custom-control-input" id="customswitch7{{k}}"
                                formControlName="o_sms_cancel">
                              <label class="custom-control-label" for="customswitch7{{k}}"></label>
                            </div>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" [disabled]="!busForm.valid" (click)="updateContactinfo()" class="btn btn-primary"
              ngbAutofocus>{{ModalBtn}}</button>
            <button type="button" class="btn btn-default" data-dismiss="modal" #defaultClick
              (click)="modal.dismiss('Cross click')">Close</button>
          </div>
        </ng-template>


        <ng-template #BusRoutes let-modal>
          <div class="modal-header">
            <h5 class="ng-tns-c116-5" id="boxheading">{{ModalHeading}}</h5>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-sm-12">
                <div class="form-material">
                  <div class="right-icon-control">
                    <form [formGroup]="busForm" class="editForm" novalidate>


                      <aw-wizard #wizard class="arc-wizard arc-custom" navBarLayout="large-filled-symbols">
                       
                        <aw-wizard-step stepTitle="Seat Layout"
                          [navigationSymbol]="{ symbol: '&#xe840;', fontFamily: 'feather' }" [style.font-weight]="900">

                          <div class="row">

                            <div class="row form-group col-sm-12">
                              <div class="col-md-3">
                        
                                <ng-select [items]="seatLayouts" bindLabel="name" bindValue="id" placeholder="Choose Seat Layout"
                                  formControlName="bus_seat_layout_id" [clearable]="false" (change)="getSeatLayout($event)">
                                </ng-select>
                                <span class="text-danger"
                                  *ngIf="busForm.controls['bus_seat_layout_id'].touched && busForm.controls['bus_seat_layout_id'].hasError('required')">
                                  Seat Layout is required! </span>
                        
                              </div>
                              <div class="col-md-9">
                                <div formArrayName="bus_seat_layout_data" class="col-12">
                        
                                  <div class="row"
                                    *ngFor="let layoutRow of busForm.controls.bus_seat_layout_data.controls; let layout_row=index;"
                                    [formGroupName]="layout_row">
                                    <div formArrayName="lowerBerth" class="col-12" style="display: flex;justify-content: center;">
                                      <div
                                        *ngFor="let layoutCol of layoutRow['controls'].lowerBerth['controls']; let layout_row=index;"
                                        [formGroupName]="layout_row" style="width: 50px; float: left;  text-align: center;">
                                        <!-- (change)="chooseSeat($event.target.checked,layoutCol.controls.seatType.value,layoutCol.controls.seatText.value,1)" -->
                                        <label class="seatHolder">
                                          <input type="checkbox" formControlName="seatChecked"
                                            *ngIf="layoutCol.controls.seatType.value!=4">
                                          <span class="seaterImage" *ngIf="layoutCol.controls.seatType.value==1"></span>
                                          <span class="sleeperImage" *ngIf="layoutCol.controls.seatType.value==2"></span>
                                          <span class="verticalImage" *ngIf="layoutCol.controls.seatType.value==3"></span>
                                          <span class="blankImage" *ngIf="layoutCol.controls.seatType.value==4"></span>
                                          <span
                                            *ngIf="layoutCol.controls.seatType.value!=4">{{layoutCol.controls.seatText.value}}</span>
                        
                                        </label>
                                      </div>
                                    </div>
                        
                                    <div formArrayName="upperBerth" class="col-12" style="display: flex;justify-content: center;">
                                      <div
                                        *ngFor="let layoutCol of layoutRow['controls'].upperBerth['controls']; let layout_row=index;"
                                        [formGroupName]="layout_row" style="width: 50px; float: left;  text-align: center;">
                        
                                        <label class="seatHolder">
                                          <input type="checkbox" formControlName="seatChecked"
                                            *ngIf="layoutCol.controls.seatType.value!=4">
                                          <span class="seaterImage" *ngIf="layoutCol.controls.seatType.value==1"></span>
                                          <span class="sleeperImage" *ngIf="layoutCol.controls.seatType.value==2"></span>
                                          <span class="verticalImage" *ngIf="layoutCol.controls.seatType.value==3"></span>
                                          <span class="blankImage" *ngIf="layoutCol.controls.seatType.value==4"></span>
                                          <span
                                            *ngIf="layoutCol.controls.seatType.value!=4">{{layoutCol.controls.seatText.value}}</span>
                        
                                        </label>
                                      </div>
                                    </div>
                                  </div>
                        
                                </div>
                        
                              </div>
                        
                            </div>
                        
                          </div>

                          <div class="col-sm-12 centered-content">
                            <div class="btn-group mt-10">
                              <button type="button" class="btn btn-primary btn-sm" awNextStep>Continue</button>
                            </div>
                          </div>

                        </aw-wizard-step>
                       
                        <aw-wizard-step stepTitle="Config Location"
                          [navigationSymbol]="{ symbol: '&#xe861;', fontFamily: 'feather' }"
                          navigationSymbolFontFamily="Font Awesome\ 5 Free" [style.font-weight]="900">

                          
                          <div formArrayName="busRoutes">
                            <div class="row">
                              <div class="col-6" *ngFor="let singleRoute of routeFormGroup.controls; let i = index;">
                                <div [formGroupName]="i" class="row">
                                  <div class="form-group col-5">
                                    <label>Location and Time <span class="text-danger">*</span></label>

                                    <ng-select [items]="locations" bindLabel="name" bindValue="id"
                                      placeholder="Select Location" formControlName="source_id"
                                      (change)="getSource($event,i)" [clearable]="false">
                                    </ng-select>
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.source_id.touched && singleRoute.controls.source_id.hasError('required')">
                                      Source is required! </span>


                                  </div>

                                  <div class="form-group col-md-3">
                                    <label>Time <span class="text-danger">*</span></label>
                                    <input type="time" formControlName="location_time" class="form-control">
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.location_time.touched && singleRoute.controls.location_time.hasError('required')">
                                      Location Time is required! </span>
                                  </div>

                                  <div class="form-group col-md-2">
                                    <label>Seq <span class="text-danger">*</span></label>
                                    <input type="text" formControlName="sequence" class="form-control">
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.sequence.touched && singleRoute.controls.sequence.hasError('required')">
                                      Sequence is required! </span>
                                  </div>
                                  <div class="form-group col-md-1 text-right">
                                    <button class="btn btn-danger btn-sm" type="button" (click)="removeRoute(i)"
                                      style="margin-top: 26px;"> X </button>
                                  </div>
                                  <div class="form-group col-md-12">
                                    <ng-container formArrayName="sourceBoarding">
                                      <ng-container
                                        *ngFor="let sourceBoardingFormGroup of singleRoute['controls'].sourceBoarding['controls']; let sourceCounts = index">
                                        <div formGroupName="{{sourceCounts}}">

                                          <div class="formgroup row" style="margin-top:10px">
                                            <div class="col-md-1 form-check">

                                              <input type="checkbox" id="source-{{i}}{{sourceCounts}}" [checked]="false"
                                                formControlName="sourcechecked">

                                            </div>
                                            <div class="col-md-6">
                                              <label
                                                for="source-{{i}}{{sourceCounts}}">{{sourceBoardingFormGroup.controls.sourceLocation.value}}</label>

                                            </div>
                                            <div class="col-md-5">
                                              <input type="time" formControlName="sourceTime"
                                                class="form-control required" placeholder="Date" atp-time-picker
                                                value="20:55" onlyHour="true" onlyAM='true'>
                                            </div>
                                          </div>
                                        </div>

                                      </ng-container>
                                    </ng-container>
                                  </div>


                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row form-group">
                            <div class="col-12 text-right"><button class="btn btn-primary btn-sm" type="button"
                                (click)="addRoute()"> Add Location +</button></div>
                          </div>
                          <div class="col-sm-12 centered-content">
                            <div class="btn-group mt-10">
                              <button type="button" class="btn btn-secondary btn-sm" awPreviousStep>Back</button>
                              <button type="button" class="btn btn-primary btn-sm" awNextStep>Continue</button>
                            </div>
                          </div>
                        </aw-wizard-step>
                        <aw-wizard-step stepTitle="Completed"
                          [navigationSymbol]="{ symbol: '&#xe840;', fontFamily: 'feather' }" [style.font-weight]="900">
                          <div class="row">
                            <div formArrayName="busRoutesInfo" class="col-12">
                              <div class="col-12"
                                *ngFor="let singleRoute of routeInfoFormGroup.controls; let i = index;">
                                <div [formGroupName]="i" class="row">
                                  <div class="form-group col-2" style="padding:0px 5px;">
                                    <label>From <span class="text-danger">*</span></label>
                                    <select class="form-control" required formControlName="from_location" type="text">
                                      <option value="" selected>Choose Location</option>
                                      <option *ngFor="let fromLocation of selectedLocations; let from_lc=index;"
                                        [value]="fromLocation[0].id">{{fromLocation[0].location_name}}</option>
                                    </select>
                                  </div>
                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="bus">On Day</label>
                                    <select class="form-control" formControlName="arr_days" type="text" placement="top"
                                      ngbTooltip="Days">
                                      <option value="1" selected>1</option>
                                      <option value="2">2</option>
                                      <option value="3">3</option>
                                      <option value="4">4</option>
                                      <option value="5">5</option>
                                    </select>
                                  </div>
                                  <div class="form-group col-2" style="padding:0px 5px;">
                                    <label>To <span class="text-danger">*</span></label>

                                    <select class="form-control" required formControlName="to_location" type="text">
                                      <option value="" selected>Choose Location</option>
                                      <option *ngFor="let toLocation of selectedLocations; let to_lc=index;"
                                        [value]="toLocation[0].id">{{toLocation[0].location_name}}</option>
                                    </select>



                                  </div>
                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="bus">On Day</label>
                                    <select class="form-control" formControlName="dep_days" type="text" placement="top"
                                      ngbTooltip="Days">
                                      <option value="1" selected>1</option>
                                      <option value="2">2</option>
                                      <option value="3">3</option>
                                      <option value="4">4</option>
                                      <option value="5">5</option>
                                    </select>
                                  </div>
                                  <div class="form-group col-md-1 " style="padding:0px 5px;">
                                    <label for="bus">Seat Fare<span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" required formControlName="seater_fare"
                                      [value]="busRecord.seater_fare" placeholder="Seater Fare" placement="top"
                                      ngbTooltip="Seater Fare" />
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.seater_fare.touched && singleRoute.controls.seater_fare.hasError('required')">
                                      Seater Fare is required! </span>
                                  </div>
                                  <div class="form-group col-md-1 " style="padding:0px 5px;">
                                    <label for="bus">Sleeper Fare<span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" required formControlName="sleeper_fare"
                                      [value]="busRecord.sleeper_fare" placeholder="Sleeper Fare" placement="top"
                                      ngbTooltip="Sleeper Fare" />
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.sleeper_fare.touched && singleRoute.controls.sleeper_fare.hasError('required')">
                                      Sleeper Fare is required! </span>
                                  </div>

                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="bus">Seize Time</label>
                                    <input type="text" class="form-control" required formControlName="booking_seized"
                                      [value]="busRecord.booking_seized" placeholder="Enter minute" placement="top"
                                      ngbTooltip="Enter minute here" (input)="getActualtime(i);"/>
                                     
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.booking_seized.touched && singleRoute.controls.booking_seized.hasError('required')">
                                      Seize Time is required! </span>
                                  </div>

                                  <div class="form-group col-md-2" style="padding:0px 5px;">
                                    <label for="bus">Actual Time</label>
                                    <input type="time" readonly class="form-control" required formControlName="actual_time"
                                      [value]="busRecord.actual_time"  placement="top"/>
                                     
                                    <span class="text-danger"
                                      *ngIf="singleRoute.controls.actual_time.touched && singleRoute.controls.actual_time.hasError('required')">
                                     Actual Time is required! </span>
                                  </div>

                                  <div class="form-group col-md-1" style="padding:0px 5px;">
                                    <label for="route_status">Status</label>
                                    <div class="custom-control custom-switch">
                                      <input type="checkbox" class="custom-control-input" id="route_status{{i}}" formControlName="route_status">
                                      <label class="custom-control-label" for="route_status{{i}}"></label>
                                      <button class="btn btn-danger btn-sm" type="button" (click)="removeRouteInfo(i)"> X </button>
                                    </div>  

                                  </div>

                                  <!-- (click)="removeRoute(i)"  -->
                                  <!-- <div class="form-group col-md-1 text-right" style="padding:0px 5px;">
                                    <label>&nbsp;</label>
                                    <button class="btn btn-danger btn-sm" type="button" (click)="removeRouteInfo(i)"
                                      style="margin-top: 32px;"> X </button>
                                  </div> -->


                                </div>
                              </div>
                            </div>
                            <div class="col-12">
                              <div class="row form-group">
                                <div class="col-12 text-right"><button class="btn btn-primary btn-sm" type="button"
                                    (click)="addRouteInfo()"> Add New Route +</button></div>
                              </div>
                            </div>

                            <div class="col-sm-12 centered-content">
                              <div class="btn-group mt-10">
                                <button type="button" class="btn btn-secondary btn-sm" awPreviousStep>Back</button>
                                <button type="button" class="btn btn-success btn-sm" awResetWizard>Finished</button>
                              </div>
                            </div>
                          </div>
                        </aw-wizard-step>
                      </aw-wizard>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <!-- [disabled]="!busForm.valid" -->
            <button type="button" (click)="UpdateRoutes()" class="btn btn-primary" ngbAutofocus>{{ModalBtn}}</button>
            <button type="button" class="btn btn-default" data-dismiss="modal" #defaultClick
              (click)="modal.dismiss('Cross click')">Close</button>
          </div>
        </ng-template>


        <!-- <ng-template #busDetails let-modal>
          <div class="modal-header">
            <h5 class="ng-tns-c116-5"> Bus Details</h5>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-sm-12">
                <div class="form-material">
                  <div class="right-icon-control">
                    Would you Like to Delete the Record
                    <form [formGroup]="formConfirm" class="editForm" novalidate>
                      <input type="hidden" formControlName="id">
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" (click)="deleteRecord()" class="btn btn-primary" ngbAutofocus>Confirm Delete</button>
            <button type="button" class="btn btn-default" data-dismiss="modal" #defaultClick
              (click)="modal.dismiss('Cross click')">Cancel</button>
          </div>
        </ng-template> -->

        <ng-template #busDetails let-modal>
          <div class="modal-header">
            <h5 class="ng-tns-c116-5" id="boxheading">{{ModalHeading}}</h5>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')"><span
                aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-sm-12">
                <div class="form-material">
                  <div class="right-icon-control">
                    <!-- Basic  Details -->
                    <table  class="table table-striped ">
                      <h5 >Bus Basic Details</h5>
                        <tr class="bg-success text-white">
                          <th>Bus Name </th>
                          <th>Bus Number</th> 
                          <th>Operator </th> 
                          <th>Via </th> 
                          <th>Bus Type </th> 
                        </tr>
                        <tr>
                          <td> {{busRecord.name}}</td>
                          <td><span class="text-danger"> <b>{{busRecord.bus_number}}</b></span></td>
                          <td><span> {{busRecord.bus_operator.organisation_name}}<br> [{{busRecord.bus_operator.operator_name}}]</span></td>
                          <td>{{busRecord.via}} </td>
                          <td>{{busRecord.bus_type.name}} </td>
                        </tr>                   
                    </table>  
                    
                    <table  class="table table-striped ">
                  
                        <tr class="bg-success text-white">
                          <th>Bus Safety </th>
                          <th>Bus Amenities</th>                          
                        </tr>
                        <tr>
                          <td> 
                            <span *ngFor="let safety of busRecord.bus_safety; let i=index; ">
                                {{safety.safety.name}},
                            </span>
                          </td>
                          <!-- <td><span class="text-danger"> <b>{{busRecord.bus_number}}</b></span></td> -->
                          <td> 
                            <span *ngFor="let amenities of busRecord.bus_amenities; let i=index; ">
                                {{amenities.amenities.name}} &nbsp;&nbsp;,
                            </span>
                          </td>
                         
                        
                        </tr>                   
                    </table> 
                  <!-- Contact Details -->
                    <table  class="table table-striped ">
                      <h5>Contact Details</h5>
                      <tr class="bg-success text-white">                      
                        <th>Person</th>
                        <th>Phone</th>
                        <td>Booking SMS</td> 
                        <td>Cancle SMS</td>
                      </tr>
                      <tr *ngFor="let contact of busRecord.bus_contacts">
                        <td>
                          <span *ngIf="contact.type==1">
                            Manager
                            </span>
                              <span *ngIf="contact.type==0">
                              Operator
                              </span>
                            <span *ngIf="contact.type==2">
                            Conductor
                          </span>
                        </td>
                        <td>
                        {{contact.phone}}
                        </td>
                        <td>
                          <span *ngIf="contact.booking_sms_send==1">
                            <i class="fa fa-check text-info" aria-hidden="true"></i>
                            </span>
                            <span *ngIf="contact.booking_sms_send !=1">
                              <i class="fa fa-times text-danger" aria-hidden="true"></i>
                              </span>
                        </td>
                        <td>
                          <span *ngIf="contact.cancel_sms_send==1">
                            <i class="fa fa-check text-info" aria-hidden="true"></i>
                            </span>
                            <span *ngIf="contact.cancel_sms_send !=1">
                              <i class="fa fa-times text-danger" aria-hidden="true"></i>
                              </span>
                        </td>
                      </tr>
                    </table>
                    <!-- Seat and Sleeper -->
                      <table class="table table-striped">
                        <h5>Bus Seat and Sleeper Details</h5>
                        <tr class="bg-success text-white">
                          <th>Seats</th>
                          <th>Sleeper</th>
                        </tr>
                        <tr>
                          <td >
                              <span class="text-info" *ngFor="let allSeats of busRecord.ticket_price[0].get_bus_seats">
                                <span *ngIf="allSeats.seats!=null">
                                  <span *ngIf="allSeats.seats.seat_class_id==1">
                                    <b>{{allSeats.seats.seatText}}</b>, 
                                  </span>
                                </span>                                
                              </span>
                          </td>
                          <td>
                            <span class="text-info text-uppercase"  *ngFor="let allSeats of busRecord.ticket_price[0].get_bus_seats">
                              <span *ngIf="allSeats.seats!=null">
                                <span *ngIf="allSeats.seats.seat_class_id==2 || allSeats.seats.seat_class_id==3">
                                  <b>{{allSeats.seats.seatText}}</b>,  
                                </span>
                              </span>
                          </span>
                          </td>
                        </tr>
                      </table>
                  <!-- Route Details -->
                    <table  class="table table-striped ">
                    <h5>Route Details</h5>
                    <tr class="bg-success text-white">
                      <th>Source</th>
                      <th>Departure Time</th>
                      <th>Journey Day</th>
                      <th>Destination</th> 
                      <th>Arrival Time</th>
                      <th>Arrival Day</th>
                      <th>Seat Fare</th>
                      <th>Sleeper Fare</th>               
                    </tr>
                    <tr *ngFor="let tktPrc of busRecord.ticket_price">
                      <td>
                        <span>
                          {{tktPrc.from_location[0].name}}<br/>
                      </span>                         
                      </td>
                      <td>
                        <span >
                         {{tktPrc.dep_time  | date:"h:mm a"}} <br/></span>
                      </td>
                      <td>
                        <span>                             
                          {{tktPrc.start_j_days}}  <br/>                          
                        </span>
                      </td>
                      <td>
                        <span>
                          {{tktPrc.to_location[0].name}}<br/></span>
                      </td>
                      <td>
                        <span >
                         {{tktPrc.arr_time | date:"h:mm a"}} <br/></span>
                      </td>
                      <td>
                        <span>                             
                          {{tktPrc.j_day}}                            
                        </span>
                      </td>

                      <td>
                        <span>
                          <i _ngcontent-wvl-c176="" class="fas fa-rupee-sign"></i>  {{tktPrc.base_seat_fare}}<br/></span>
                      </td>
                      <td>
                        <span>
                          <i _ngcontent-wvl-c176="" class="fas fa-rupee-sign"></i>  {{tktPrc.base_sleeper_fare}}<br/></span>
                      </td>
                    </tr>
                    
                </table>

                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <!-- [disabled]="!busForm.valid" -->
            <!-- <button type="button" (click)="UpdateRoutes()" class="btn btn-primary" ngbAutofocus>{{ModalBtn}}</button> -->
            <button type="button" class="btn btn-default" data-dismiss="modal" #defaultClick
              (click)="modal.dismiss('Cross click')">Close</button>
          </div>
        
        </ng-template>


      </div>




      <div class="table-responsive d-none" id="expert_table">
        <table class="table table-striped ">
          <thead>
            <tr>
              <th>#</th>
              <th>Organization Name</th>
              <th>Bus Name</th>
              <th>Bus Number</th>
              <th>Source</th>
              <th>Destination</th>
              <th>Via</th>
              <th>Bus Safety</th>
              <th>Bus Type</th>
              <th>Bus Amenities</th>
              <th>Seat Allotted</th>
              <th>Sleeper Allotted</th>
              <th>Seat Fare</th>
              <th>Sleeper Fare</th>
              <th>Departure Time</th>
              <th>Arrival Time</th>
              <th>Journey Duration</th>
              <th>Bus Operator Name</th>
              <th>Contact (Owner)</th>
              <th>Contact (Manager)</th>
              <th>Contact (Conductor)</th>
            </tr>
          </thead>
          <tbody *ngIf="buses?.length != 0">
            <tr *ngFor="let bus of buses; let i=index; ">
              <td>{{i+1}}</td>
              <td>{{ bus.bus_operator.organisation_name }}</td>
              <td>{{ bus.name }} </td>
              <td>{{ bus.bus_number}} </td>
              <td>{{ bus.ticket_price[0].from_location[0].name }}</td>
              <td>{{ bus.ticket_price[0].to_location[0].name }} </td>
              <td>{{ bus.via}} </td>
              <td>
                <span *ngFor="let safety of bus.bus_safety; let i=index; ">
                  {{safety.safety.name}},
                </span> 
              </td>
              <td>{{bus.bus_type.name}} </td>
              <td>
                <span *ngFor="let amenities of bus.bus_amenities; let i=index; ">
                  {{amenities.amenities.name}},
                </span>
              </td>
              <td>
                <span *ngFor="let allSeats of bus.ticket_price[0].get_bus_seats">
                  <span *ngIf="allSeats.seats!=null">
                    <span *ngIf="allSeats.seats.seat_class_id==1">
                      {{allSeats.seats.seatText}},  
                    </span>
                  </span>                                
                </span>
              </td>
              <td>
                <span class="text-uppercase"  *ngFor="let allSeats of bus.ticket_price[0].get_bus_seats">
                  <span *ngIf="allSeats.seats!=null">
                    <span *ngIf="allSeats.seats.seat_class_id==2 || allSeats.seats.seat_class_id==3">
                      {{allSeats.seats.seatText}} ,  
                    </span>
                  </span>
                </span>
              </td>
              <td>
                  {{bus.ticket_price[0].base_seat_fare}}
              </td>
              <td>
                  {{bus.ticket_price[0].base_sleeper_fare}}  
              </td>
              <td>{{bus.ticket_price[0].dep_time | date:'h:mm a'}} </td>
              <td>{{bus.ticket_price[0].arr_time | date:'h:mm a'}} </td>
              <td>{{bus.ticket_price[0].j_day}} Day(s)</td>
              <td>{{bus.bus_operator.operator_name}} </td>
              <td> 
                <span *ngFor="let owner of bus.bus_contacts ">
                  <span *ngIf="owner.type == 0">
                    {{owner.phone}}
                  </span>
                </span>
              </td>
              <td> 
                <span *ngFor="let manager of bus.bus_contacts ">
                  <span *ngIf="manager.type == 1">
                    {{manager.phone}}
                  </span>
                </span>
              </td>
              <td> 
                <span *ngFor="let conductor of bus.bus_contacts ">
                  <span *ngIf="conductor.type == 2">
                    {{conductor.phone}}
                  </span>
                </span>
              </td>
            </tr>
            
          </tbody>
        </table>
        
        
      </div>



    </app-card>
  </div>
</div>